# covid-convlstm-one-code
  The rapid outbreak of COVID-19 has affected the lives and livelihoods of a large section of the society. Hence, to confine the rapid spread of this virus, early detection of COVID-19 is extremely important. One of the popular ways of detecting COVID-19 is by using chest X-ray images. In literature, it is found that most of the front line works used convolutional neural network (CNN) models where features generated by the last convolutional layers were directly passed to the classification models. However, here we also use convolutional long short term memory (ConvLSTM) layer to encode the spatial dependency among the feature maps obtained from the last convolutional layer of the CNN models in use. This helps the whole model improve its image representational capability. Additionally, we employ squeeze-and-excitation (SE) block, spacial attention mechanism, which helps the network to allocate better weights to the important local features. We first apply these two mechanisms on three popular CNN models - VGG19, InceptionV3 and MobileNetV2 to improve their classification strength, and then we use Sugeno fuzzy integral based ensembling method on these classifiers' outputs to improve the detection accuracy further. For experiments, we prepare a database containing chest X-ray images of normal subjects, COVID-19 and Pneumonia infected patients from publicly available datasets. The classification accuracies obtained by using only the pre-trained VGG19, InceptionV3 and MobileNetV2 models as classifiers are 97.40\%, 96.58\% and 97.72\% respectively. After adding ConvLSTM layers to each of the classifiers using pre-trained models of VGG19, InceptionV3 and MobileNetV2, the accuracies we get are 97.72\%, 97.80\% and 97.88\% respectively. Again after adding SE block to each of the improved classifiers using pre-trained models of VGG19, Incpetion V3 and MobileNetV2, the classification accuracies that they give are 97.96\%, 98.94\% and 98.45\% respectively. Finally, after applying the Sugeno integral based ensembling method, we obtain 99.35\% classification accuracy on the present dataset.

# Proposed Work
In this work, an ensemble method of three classifiers by using the Sugeno integral method is proposedfor COVID-19 detection from chest X-ray images.  These classifiers are based on the pre-trained modelsof  VGG19,  InceptionV3,  and  MobileNet,  and  in  all  three  classifiers,  ConvLSTM  layers  are  used  forestablishing spatial dependency encoding on the extracted features.  Next, SE blocks are used to suppressthe less useful features obtained from the previous steps, and then the chest X-ray images are classifiedusing two fully connected (FC) layers with the generated features.  Lastly, the output predictions fromthe base classifiers (i.e., pre-trained models + ConvLSTM + SE Blocks + 2 FC layers) are combinedusing the Sugeno fuzzy integral method to generate the final prediction results.  The architecture of theentire method is shown below.
![new_ensemble (1)](https://user-images.githubusercontent.com/46515291/155028862-0e20afea-ac1b-4b8d-8383-1c6266c99020.jpg)

# Convolutional LSTM Layer.
 ConvLSTM layers help in capturing the temporal dependencies present in the inputdata. They do this by using LSTM networks which are known for passing and storing information fromprevious steps to the present step of the underlying time series data. Hence, they establish an encodingin the input data. The internal working structure of the ConvLSTM layer is shown below.
![ConvLSTM (1) (1) (2)](https://user-images.githubusercontent.com/46515291/155029140-d8d77815-87a3-42f2-a8e7-fd91dd265384.jpg)

# Squeeze and Excitation Network

SE blocks  can  be  placed  inlarge CNNs to establish attention among the features. By doing so, an SE block creates a system wherethe most important features are highlighted more, whereas the features which are not that importantare suppressed. In this way, the performance of a deep learning model can be improved by suppressingredundant or non-important features from being fed to the classification model as noisy data that may hamper the performance of the overall model.  The working procedure of the SE blocks and also the layers used for creating an SE block are shown in below.

![se_attention (1)](https://user-images.githubusercontent.com/46515291/155029457-c23caf9a-92bb-4465-a01a-b9ed08e978b0.jpg)


# System architechture

At first, 224×224 dimensional chest X-ray images are inputted to the base classifiers.  Pre-trainedmodels VGG19, Inception V3, and MobileNet extract feature maps of dimension 7×7×512, 8×8×2048,and 7×7×1024 respectively.  Next, these feature maps are passed through ConvLSTM  networks  with  multiple  kernel  sizes  and  the  outputs  so  obtained  are  fused.   The  reason for using  ConvLSTM  blocks  is  that  the  convolutional  layers,  after  extracting  feature  maps  from  aninput  image,  send  them  to  an  LSTM  layer  which  passes  the  most  relevant  information  and  discardsthe unnecessary information by encoding the spatial dependencies among the feature maps.  Next, SE attention is employed on the feature maps from the ConvLSTM layer to give priority to those featureswhich are important and suppress the ones which are not so important.  For calculating the fuzzy measure values for the application of Sugeno fuzzy integral, a validation dataset is used. During testing, first atest sample is passed through the base classifiers to obtain prediction scores and then using these scores in Sugeno fuzzy integral we obtain final prediction label.
![experimental_fuzzy (2) (1)](https://user-images.githubusercontent.com/46515291/155029692-54b2cb3d-af14-46ad-9250-f246e0ff34a2.jpg)



